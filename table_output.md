### PD Performance

| Panel Title | Description | Query/Expression |
|---|---|---|
| PD Instance |  | `count(     group by (label0,label1) (         label_replace(             label_replace(                 label_replace(                     sum by (exported_endpoint)(                         glm_watched_endpoints{region=~"$region",job=~"$namespace/$app-lb",cluster="",pool =~ "^$\|^($pool1);($pool2);($pool3);;;$"}                     ) > 0,                     "label0", "$1",                     "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"                     ),                 "label1", "$2",                 "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"             ),             "label2", "$3",         "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"         )     ) )` |
| PD Instance |  | `count by (label0)(     count by (label0,label1) (         label_replace(             label_replace(                 label_replace(                     sum by (exported_endpoint)(                         glm_watched_endpoints{region=~"$region",job=~"$namespace/$app-lb",cluster="",pool =~ "^$\|^($pool1);($pool2);($pool3);;;$"}                     ) > 0,                     "label0", "$1",                     "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"                     ),                 "label1", "$2",                 "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"             ),             "label2", "$3",         "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"         )     ) )` |
| Pods by dprank |  | `count(sum(glm_watched_endpoints{region=~"$region",job=~"$namespace/$app-lb",cluster="",pool =~ "^$\|^($pool1);($pool2);($pool3);;;$"}) by (exported_endpoint) > 0)` |
| Pods by dprank |  | `count by (label0) (     label_replace(         label_replace(             label_replace(                 sum by (exported_endpoint)(                     glm_watched_endpoints{region=~"$region",job=~"$namespace/$app-lb",cluster="",pool =~ "^$\|^($pool1);($pool2);($pool3);;;$"}                 ) > 0,                 "label0", "$1",                 "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"                 ),             "label1", "$2",             "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"         ),         "label2", "$3",     "exported_endpoint", "^([^:]+):([^:]+)(?::([^:]+))?$"     ) )` |
| [Prefill] E2E Request Latency in $region | End-to-end request latency in seconds (Prefill-Decode disaggregated) | `sum by (job)(rate(sglang:e2e_request_latency_seconds_sum{region=~"$region",cluster="",job=~"$namespace/$app-prefill"}[$__rate_interval]))  / sum by (job)(rate(sglang:e2e_request_latency_seconds_count{region=~"$region",cluster="",job=~"$namespace/$app-prefill"}[$__rate_interval]))` |
| [Prefill] SGL Request | Number of requests processed. (Prefill-Decode disaggregated) | `sum(     rate(         sglang:num_requests_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval]     ) ) by (region)` |
| [Decode] Time To First Token | time to first token in seconds. (Prefill-Decode disaggregated) <br>In PD-disaggregated mode, decode instance is responsible for output the first token | `histogram_quantile( 0.99,   sum by (le) (       rate(         sglang:time_to_first_token_seconds_bucket       {cluster="",job=~"$namespace/$app-decode",region=~"$region"}[1m]       )   ) )` |
| [Decode] First Token Latency (By Cluster) | first-token latency in seconds.  (Prefill-Decode disaggregated) | `sum(rate(sglang:time_to_first_token_seconds_sum{region=~"$region",cluster="",job=~"$namespace/$app-decode"}[$__rate_interval])) by (region) / sum(rate(sglang:time_to_first_token_seconds_count{region=~"$region",cluster="",job=~"$namespace/$app-decode"}[$__rate_interval])) by (region) * 1000` |
| [Decode] E2E Request Latency in $region | End-to-end request latency in seconds (Prefill-Decode disaggregated) | `histogram_quantile(0.99, sum by(le) (rate(sglang:e2e_request_latency_seconds_bucket{region=~"$region",cluster="",job=~"$namespace/$app-decode"}[$__rate_interval])))` |
| [Decode] SGL Request | Number of requests processed. (Prefill-Decode disaggregated) | `sum(     rate(         sglang:num_requests_total{region=~"$region",job=~"$namespace/$app-decode",cluster=""}[$__rate_interval]     ) ) by (region)` |
| [Decode] Inter Token Latency | inter-token latency in seconds. inter-token即输出token间延迟，即decode latency (Prefill-Decode disaggregated) | `sum(rate(sglang:inter_token_latency_seconds_sum{region=~"$region",cluster="",job=~"$namespace/$app-decode"}[$__rate_interval]))  / sum(rate(sglang:inter_token_latency_seconds_count{region=~"$region",cluster="",job=~"$namespace/$app-decode"}[$__rate_interval])) * 1000` |
| [Decode] Inter Token Latency (By Cluster) | inter-token latency in seconds. inter-token即输出token间延迟，即decode latency (Prefill-Decode disaggregated) | `sum(rate(sglang:inter_token_latency_seconds_sum{region=~"$region",cluster="",job=~"$namespace/$app-prefill"}[$__rate_interval])) by (region) / sum(rate(sglang:inter_token_latency_seconds_count{region=~"$region",cluster="",job=~"$namespace/$app-prefill"}[$__rate_interval])) by (region) * 1000` |
| [Prefill] Running Requests in $region | The number of running requests. (Prefill-Decode disaggregated) | `avg(     sglang:num_running_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""} )` |
| [Prefill] Running Request |  | `max(sglang:num_running_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}) by (pod)` |
| [Prefill] Avg Queue Size | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `avg(sglang:num_queue_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Prefill] Queue Size |  | `max(sglang:num_queue_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}) by (pod)` |
| [Decode] Running Requests in $region | The number of running requests. (Prefill-Decode disaggregated) | `avg(     sglang:num_running_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""} )` |
| [Decode] Running Request |  | `max(sglang:num_running_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (pod)` |
| [Decode] Avg Queues Size | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `avg(sglang:num_queue_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Transfer Queue Size |  | `max(sglang:num_decode_transfer_queue_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (pod)` |
| [Prefill] Queue Size By Instance | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `avg by (pod)(sglang:num_queue_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Prefill] Pre-Alloc Queue Size By Instance | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `avg by (pod)(sglang:num_prefill_prealloc_queue_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Prefill] Inflight Queue Size By Instance | The number of requests in the transferring queue. (Prefill-Decode disaggregated) | `avg by (pod) (sglang:num_prefill_inflight_queue_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Decode] Queue Size | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `sum by (pod) (sglang:num_queue_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Pre-Alloc Queue Size | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `sum by (pod)(sglang:num_decode_prealloc_queue_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Transfer Queue Size | The number of requests in the waiting queue. (Prefill-Decode disaggregated) | `sum by (pod) (sglang:num_decode_transfer_queue_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Prefill] Bootstrap Latency | Prefill-side bootstrap latency (Prefill-Decode disaggregated) | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_bootstrap"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_bootstrap"})[$__interval])` |
| [Prefill] Waiting Latency | Prefill-side waiting latency, request is bootstrapped but waiting other request forwarded (Prefill-Decode disaggregated) | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_waiting"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_waiting"})[$__interval])` |
| [Prefill] Forward Latency | Prefill-side forward latency (Prefill-Decode disaggregated) | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_forward"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_forward"})[$__interval])` |
| [Prefill] Transfer KV Cache Latency | Prefill-side KV cache transfer latency (Prefill-Decode disaggregated) | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_transfer_kv_cache"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_transfer_kv_cache"})[$__interval])` |
| [Decode] Prepare Latency | Decode-side prepare latency, prepare is the fisrt stage in decode instance, before bootstrap. | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-decode",stage="decode_prepare"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-decode",stage="decode_prepare"})[$__interval])` |
| [Decode] Bootstrap Latency | Decode-side bootstrap latency (Prefill-Decode disaggregated) | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-decode",stage="decode_bootstrap"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-decode",stage="decode_bootstrap"})[$__interval])` |
| [Decode] Transferred Latency | Decode-side latency before KV cache is transferred. This includes all latency in prefill to bootstrap+forward+transfer. See prefill-side transfer latency for pure transfer latency. | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-decode",stage="decode_transferred"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-decode",stage="decode_transferred"})[$__interval])` |
| [Decode] Waiting Latency | Decode-side waiting latency, request is bootstrapped but waiting for batching with other request to forward, if this is high, typically the token usage is full or max_running_request is hit. | `avg(rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-decode",stage="decode_waiting"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-decode",stage="decode_waiting"})[$__interval])` |
| [Prefill] Bootstrap Latency By Instance | Prefill-side bootstrap latency (Prefill-Decode disaggregated) | `avg by (pod) (rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_bootstrap"})[$__rate_interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_bootstrap"})[$__rate_interval])` |
| [Prefill] Forward Latency By Instance | Prefill-side forward latency (Prefill-Decode disaggregated) | `avg by (pod) (rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_forward"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_forward"})[$__interval])` |
| [Prefill] Wait Latency By Instance | Prefill-side wait latency (Prefill-Decode disaggregated) | `avg by (pod) (rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_waiting"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_waiting"})[$__interval])` |
| [Prefill] Transfer Latency By Instance | Prefill-side transfer latency (Prefill-Decode disaggregated) | `avg by (pod) (rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_transfer_kv_cache"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-prefill",stage="prefill_transfer_kv_cache"})[$__interval])` |
| [Decode] Transferred Latency By Instance | Decode-side latency before KV cache is transferred. This includes all latency in prefill to bootstrap+forward+transfer. See prefill-side transfer latency for pure transfer latency. | `avg by (pod) (rate(sglang:per_stage_req_latency_seconds_sum{region=~"$region",job=~"$namespace/$app-decode",stage="decode_transferred"})[$__interval] / rate(sglang:per_stage_req_latency_seconds_count{region=~"$region",job=~"$namespace/$app-decode",stage="decode_transferred"})[$__interval])` |
| [Prefill] Token Usage in $region | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `avg(sglang:token_usage{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Prefill] Token Usage (By Cluster) | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `avg(sglang:token_usage{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}) by (region)` |
| [Prefill] Token Usage | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `max(sglang:token_usage{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}) by (pod, region)` |
| [Prefill] Cached Tokens | Rate of number of cached prompt tokens. (Prefill-Decode disaggregated) | `sum(rate(sglang:cached_tokens_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval]))` |
| [Decode] Token Usage in $region | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `avg(sglang:token_usage{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Token Usage (By Cluster) | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `avg(sglang:token_usage{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (region)` |
| [Decode] Token Usage | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `max(sglang:token_usage{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (pod, region)` |
| [Prefill] Prefix Cache HitRate | The prefix cache hit rate. (Prefill-Decode disaggregated) | `avg(sglang:cache_hit_rate{region=~"$region",cluster="",job=~"$namespace/$app-prefill"})` |
| [Prefill] Prefill Throughput in $region | Number of prefill tokens processed (Prefill-Decode disaggregated) | `sum(rate(sglang:prompt_tokens_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval]))` |
| [Prefill] Token Throughput / Instance (by Cluster) |  | `avg(rate(sglang:prompt_tokens_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval])) by (region)` |
| [Prefill] Thoughput | Number of prefill tokens processed. (Prefill-Decode disaggregated) | `avg(rate(sglang:prompt_tokens_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval])) by (pod, region)` |
| [Decode] Aborted Requests (by Cluster) |  | `sum(     rate(sglang:num_aborted_requests_total{region=~"$region",job=~"$namespace/$app-decode",cluster=""}[$__rate_interval]) ) by (region)` |
| [Prefill] Aborted Requests (by Cluster) |  | `sum(     rate(sglang:num_aborted_requests_total{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval]) ) by (region)` |
| [Decode] Generation Throughput in $region |  | `avg(rate(sglang:generation_tokens_total{region=~"$region",job=~"$namespace/$app-decode",cluster=""}[$__rate_interval]))` |
| [Decode] Throughput / Instance (by Cluster) |  | `avg(     sglang:gen_throughput{region=~"$region",job=~"$namespace/$app-decode",cluster=""} ) by (region)` |
| [Decode] Thoughput | Number of decode tokens generated.  (Prefill-Decode disaggregated) | `avg(rate(sglang:prompt_tokens_total{region=~"$region",job=~"$namespace/$app-decode",cluster=""}[$__rate_interval])) by (pod, region)` |
| [Decode] Retracted Requests (by Cluster) |  | `sum(     rate(sglang:total_retracted_reqs{region=~"$region",job=~"$namespace/$app-prefill",cluster=""}[$__rate_interval]) ) by (region)` |
| [Prefill] Avg iB Xmit Speed |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_data_transmitted_bytes_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ) * 8)     * on(node) group_right(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-prefill",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, owner_name)` |
| [Prefill] Avg iB Xmit Packet Rate |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_packets_transmitted_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ))     * on(node) group_right(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-prefill",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, owner_name)` |
| [Prefill] Avg iB Xmit Speed |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_data_transmitted_bytes_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ) * 8)     * on(node) group_left(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-prefill",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, pod)` |
| [Decode] Accept Length Of Speculative | The average acceptance length of speculative decoding. (Prefill-Decode disaggregated) | `avg by (region) (sglang:spec_accept_length{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Avg iB Recv Speed |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_data_received_bytes_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ) * 8)     * on(node) group_right(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-decode",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, owner_name)` |
| [Decode] Avg iB Recv Packet Rate |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_packets_received_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ))     * on(node) group_right(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-decode",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, owner_name)` |
| [Decode] Avg iB Recv Speed |  | `avg(     sum by (region,node) (irate(         node_infiniband_port_data_received_bytes_total{         region=~"$region", device=~"mlx5_.*"         }[$__rate_interval]     ) * 8)     * on(node) group_left(pod, namespace)     (         kube_pod_info{region=~"$region"}         and on(pod, namespace)         (         kube_pod_owner{owner_kind="ReplicaSet", region=~"$region"}         and on(owner_name, namespace)         label_replace(             kube_replicaset_owner{             owner_kind="Deployment", namespace=~"$namespace", region=~"$region", owner_name=~"$app-decode",             },             "owner_name", "$1", "replicaset", "(.*)"         )         )     ) ) by (region, namespace, pod)` |
| [Prefill] Queue Lantency | The average request queue latency for the last batch of requests in seconds.  (Prefill-Decode disaggregated) | `avg(sglang:avg_request_queue_latency{region=~"$region",job=~"$namespace/$app-prefill",cluster=""})` |
| [Decode] Queue Lantency | The average request queue latency for the last batch of requests in seconds.  (Prefill-Decode disaggregated) | `avg(sglang:avg_request_queue_latency{region=~"$region",job=~"$namespace/$app-decode",cluster=""})` |
| [Decode] Token Usage (By DP Rank) | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `max(sglang:token_usage{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (region,pod,dp_rank)` |
| [Decode] Running Req Num (By DP Rank) | indicates the KV cache memory utilization of the server.  (Prefill-Decode disaggregated) | `max(sglang:num_running_reqs{region=~"$region",job=~"$namespace/$app-decode",cluster=""}) by (region,pod,dp_rank)` |



### PD Network

| Panel Title | Description | Query/Expression |
|---|---|---|
| Total Pod Bandwidth | Total RX + TX bandwidth for all Decode and Prefill pods | `sum(     rate(container_network_receive_bytes_total{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"     }[5m]) +     rate(container_network_transmit_bytes_total{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"     }[5m]) )` |
| Pod Network Receive Rate |  | `sum(     rate(container_network_receive_bytes_total{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"     }[5m]) )` |
| Pod Network Transmit Rate |  | `sum(     rate(container_network_transmit_bytes_total{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"     }[5m]) )` |
| Pod RX/TX Ratio |  | `sum(rate(container_network_receive_bytes_total{namespace="$namespace",pod=~"$app-(decode\|prefill).*"}[5m])) / sum(rate(container_network_transmit_bytes_total{namespace="$namespace",pod=~"$app-(decode\|prefill).*"}[5m]))` |
| Decode Pods RX Rate per Instance | Individual RX rate for each Decode pod | `sum by (pod) (     rate(container_network_receive_bytes_total{         namespace="$namespace",         pod=~"$app-decode.*"     }[5m]) )` |
| Decode Pods TX Rate per Instance |  | `sum by (pod) (     rate(container_network_transmit_bytes_total{         namespace="$namespace",         pod=~"$app-decode.*"     }[5m]) )` |
| Prefill Pods RX Rate per Instance |  | `sum by (pod) (     rate(container_network_receive_bytes_total{         namespace="$namespace",         pod=~"$app-prefill.*"     }[5m]) )` |
| Prefill Pods TX Rate per Instance |  | `sum by (pod) (     rate(container_network_transmit_bytes_total{         namespace="$namespace",         pod=~"$app-prefill.*"     }[5m]) )` |
| Decode Pods RX - Max/Avg/Mean |  | `max(     sum by (pod) (         rate(container_network_receive_bytes_total{             namespace="$namespace",             pod=~"$app-decode.*"         }[5m])     ) )` |
| Decode Pods TX - Max/Avg/Mean |  | `max(     sum by (pod) (         rate(container_network_transmit_bytes_total{             namespace="$namespace",             pod=~"$app-decode.*"         }[5m])     ) )` |
| Prefill Pods RX - Max/Avg/Mean |  | `max(     sum by (pod) (         rate(container_network_receive_bytes_total{             namespace="$namespace",             pod=~"$app-prefill.*"         }[5m])     ) )` |
| Prefill Pods TX - Max/Avg/Mean |  | `max(     sum by (pod) (         rate(container_network_transmit_bytes_total{             namespace="$namespace",             pod=~"$app-prefill.*"         }[5m])     ) )` |
| IB RX（Decode Scoped) |  | `sum by (instance, node) (   rate(node_infiniband_port_data_received_bytes_total[1m]) ) * on (node) group_left() (   count by (node) (     kube_pod_info{       namespace="$namespace",       pod=~"$app-decode.*"     }   ) > 0 )` |
| IB TX（Decode Scoped) |  | `sum by (instance, node) (   rate(node_infiniband_port_data_transmitted_bytes_total[1m]) ) * on (node) group_left() (   count by (node) (     kube_pod_info{       namespace="$namespace",       pod=~"$app-decode.*"     }   ) > 0 )` |
| IB RX（Prefill Scoped) |  | `sum by (instance, node) (   rate(node_infiniband_port_data_received_bytes_total[1m]) ) * on (node) group_left() (   count by (node) (     kube_pod_info{       namespace="$namespace",       pod=~"$app-prefill.*"     }   ) > 0 )` |
| IB TX（Prefill Scoped) |  | `sum by (instance, node) (   rate(node_infiniband_port_data_transmitted_bytes_total[1m]) ) * on (node) group_left() (   count by (node) (     kube_pod_info{       namespace="$namespace",       pod=~"$app-prefill.*"     }   ) > 0 )` |
| IB RX/TX Ratio |  | `(   sum by(instance, node) (     rate(node_infiniband_port_data_received_bytes_total[1m])   )   *   on(node)   group_left()   (     count by(node) (       kube_pod_info{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"       }     ) > 0   ) ) / (   sum by(instance, node) (     rate(node_infiniband_port_data_transmitted_bytes_total[1m])   )   *   on(node)   group_left()   (     count by(node) (       kube_pod_info{         namespace="$namespace",         pod=~"$app-(decode\|prefill).*"       }     ) > 0   ) )` |
| InfiniBand Network Transmit Wait |  | `max by (instance, node) (   rate(node_infiniband_port_transmit_wait_total[1m]) ) * on (node) group_left() (   count by (node) (     kube_pod_info{       namespace="$namespace",       pod=~"$app-decode.*"     }   ) > 0 )` |

